%%%%%%%%%%%%%%%%%%%%%%% ioppreprint.sty %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%%%%%% Preprint style for articles to be submitted to IOP journals
%
%%%%%%% Prepared by AJC 12/2/88, updated 1/2/89 and by SW 12/2/91
%%%%%%% Last modified by JFM 05/05/92
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% First we have a character check
%
% ! exclamation mark    " double quote  
% # hash                ` opening quote (grave)
% & ampersand           ' closing quote (acute)
% $ dollar              % percent       
% ( open parenthesis    ) close paren.  
% - hyphen              = equals sign
% | vertical bar        ~ tilde         
% @ at sign             _ underscore
% { open curly brace    } close curly   
% [ open square         ] close square bracket
% + plus sign           ; semi-colon    
% * asterisk            : colon
% < open angle bracket  > close angle   
% , comma               . full stop
% ? question mark       / forward slash 
% \ backslash           ^ circumflex
%
% ABCDEFGHIJKLMNOPQRSTUVWXYZ 
% abcdefghijklmnopqrstuvwxyz 
% 1234567890
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%% Dimensions (page width is width of journal page x1.2) %%%%%%%

\magnification=1200
%
%
\hsize=31pc
\vsize=55 truepc
\hfuzz=2pt
\vfuzz=4pt
\pretolerance=5000
\tolerance=5000
\parskip=0pt plus 1pt
\parindent=16pt
%


%%%%%%%%%%%%%%%%%%%%%%%%% Font definitions %%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Fonts for title
%
\font\fourteenrm=cmr10 scaled \magstep2
\font\fourteeni=cmmi10 scaled \magstep2
\font\fourteenbf=cmbx10 scaled \magstep2
\font\fourteenit=cmti10 scaled \magstep2
\font\fourteensy=cmsy10 scaled \magstep2

% Font for small caps within title and authors names
%
\font\large=cmbx10 scaled \magstep1

% Font for matrices (please replace with cmbx10 
% if you do not have this font available)
%
\font\sans=cmssbx10

% Font for matrices (use \bss{x} for bold sans serif within maths)
%
\def\bss#1{\hbox{\sans #1}}

% Font for vectors (bold italic). Please replace with cmbx10
% if you do not have this font available.
% Use \bi{r} for bold italic r within maths 
%
\font\bdi=cmmib10
\def\bi#1{\hbox{\bdi #1\/}}

% Fonts for small type (if used)
%
\font\eightrm=cmr8  
\font\eighti=cmmi8
\font\eightbf=cmbx8
\font\eightit=cmti8
\font\eightsl=cmsl8
\font\eightsy=cmsy8
\font\sixrm=cmr6
\font\sixi=cmmi6
\font\sixsy=cmsy6
\font\sixbf=cmbx6

%%%% Definitions of tenpoint, eightpoint and fourteenpoint families
%
\def\tenpoint{\def\rm{\fam0\tenrm}%
  \textfont0=\tenrm \scriptfont0=\sevenrm 
                      \scriptscriptfont0=\fiverm
  \textfont1=\teni  \scriptfont1=\seveni 
                      \scriptscriptfont1=\fivei
  \textfont2=\tensy \scriptfont2=\sevensy 
                      \scriptscriptfont2=\fivesy
  \textfont3=\tenex   \scriptfont3=\tenex 
                      \scriptscriptfont3=\tenex
  \textfont\itfam=\tenit  \def\it{\fam\itfam\tenit}%
  \textfont\slfam=\tensl  \def\sl{\fam\slfam\tensl}%
  \textfont\bffam=\tenbf  \scriptfont\bffam=\sevenbf
                            \scriptscriptfont\bffam=\fivebf
                            \def\bf{\fam\bffam\tenbf}%
  \normalbaselineskip=20 truept
  \setbox\strutbox=\hbox{\vrule height14pt depth6pt
width0pt}%
  \let\sc=\eightrm \normalbaselines\rm}
%
\def\eightpoint{\def\rm{\fam0\eightrm}%
  \textfont0=\eightrm \scriptfont0=\sixrm 
                      \scriptscriptfont0=\fiverm
  \textfont1=\eighti  \scriptfont1=\sixi
                      \scriptscriptfont1=\fivei
  \textfont2=\eightsy \scriptfont2=\sixsy
                      \scriptscriptfont2=\fivesy
  \textfont3=\tenex   \scriptfont3=\tenex
                      \scriptscriptfont3=\tenex
  \textfont\itfam=\eightit  \def\it{\fam\itfam\eightit}%
  \textfont\bffam=\eightbf  \def\bf{\fam\bffam\eightbf}%
  \normalbaselineskip=16 truept
  \setbox\strutbox=\hbox{\vrule height11pt depth5pt width0pt}}
%
\def\fourteenpoint{\def\rm{\fam0\fourteenrm}%
  \textfont0=\fourteenrm \scriptfont0=\tenrm 
                      \scriptscriptfont0=\eightrm
  \textfont1=\fourteeni  \scriptfont1=\teni 
                      \scriptscriptfont1=\eighti
  \textfont2=\fourteensy \scriptfont2=\tensy 
                      \scriptscriptfont2=\eightsy
  \textfont3=\tenex   \scriptfont3=\tenex 
                      \scriptscriptfont3=\tenex
  \textfont\itfam=\fourteenit  \def\it{\fam\itfam\fourteenit}%
  \textfont\bffam=\fourteenbf  \scriptfont\bffam=\tenbf
                             \scriptscriptfont\bffam=\eightbf
                             \def\bf{\fam\bffam\fourteenbf}%
  \normalbaselineskip=24 truept
  \setbox\strutbox=\hbox{\vrule height17pt depth7pt width0pt}%
  \let\sc=\tenrm \normalbaselines\rm}
%
\def\today{\number\day\ \ifcase\month\or
  January\or February\or March\or April\or May\or June\or
  July\or August\or September\or October\or November\or
December\fi
  \space \number\year}

%%%%%%%%%%%%%%%%%%%%%%%% Counter definitions %%%%%%%%%%%%%%%%%%%%%%%%
%
\newcount\secno      %section number
\newcount\subno      %number of subsection
\newcount\subsubno   %number of subsubsection
\newcount\appno      %appendix number
\newcount\tableno    %table number
\newcount\figureno   %figure number
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Baselineskip %%%%%%%%%%%%%%%%%%%%%%%%%%
%
\normalbaselineskip=20 truept
\baselineskip=20 truept

%%%%%%%%%%%%%%%%%%%% Specific formatting commands %%%%%%%%%%%%%%%%%%%
%
% Title of article
%
\def\title#1
   {\vglue1truein
   {\baselineskip=24 truept
    \pretolerance=10000
    \raggedright
    \noindent \fourteenpoint\bf #1\par}
    \vskip1truein minus36pt}
%

% Author names
% (The names of all the authors should be in the form initials then 
% surname. There should be no points after initials.)
%
\def\author#1
  {{\pretolerance=10000
    \raggedright
    \noindent {\large #1}\par}}

% Address of the authors
% (If authors are at differing addresses use one \address for each)
%
\def\address#1
   {\bigskip
    \noindent \rm #1\par}

% Short title (not more than fifty characters)
%
\def\shorttitle#1
   {\vfill
    \noindent \rm Short title: {\sl #1}\par
    \medskip}

% Physics Abstracts classification numbers
%
\def\pacs#1
   {\noindent \rm PACS number(s): #1\par
    \medskip}

% Journal article submitted to
%
\def\jnl#1
   {\noindent \rm Submitted to: {\sl #1}\par
    \medskip}

% Today's date
%
\def\date
   {\noindent Date: \today\par
    \medskip}

% Start of abstract
%
\def\beginabstract
   {\vfill\eject
    \noindent {\bf Abstract. }\rm}

% Keyword abstract - only required for J. Phys. G
%
\def\keyword#1
   {\bigskip
    \noindent {\bf Keyword abstract: }\rm#1}

% End of abstract
%
\def\endabstract
   {\par
    \vfill\eject}

% Contents page (only required for Reports on Progress in Physics)
%
% Heading for contents page
%
\def\contents
   {{\noindent
    \bf Contents
    \par}
    \rightline{Page}}

% Entry in list of contents (section headings)
%
\def\entry#1#2#3
   {\noindent
    \hangindent=20pt
    \hangafter=1
    \hbox to20pt{#1 \hss}#2\hfill #3\par}

% Subentry in list of contents (subsection heading).
% (Subsubsection headings do not appear in the contents list)
%
\def\subentry#1#2#3
   {\noindent
    \hangindent=40pt
    \hangafter=1
    \hskip20pt\hbox to20pt{#1 \hss}#2\hfill #3\par}
%
%
\def\checkforsub{\futurelet\nexttok\decide}
\def\ssf{\relax}
\def\decide{\if\nexttok\ssf\let\endspace=\nospace
                \else\let\endspace=\extraspace\fi\endspace}
\def\nospace{\nobreak\par\nobreak}
%
% Section heading (#1 is title of section, no number required)
%
\def\section#1{%
    \goodbreak
    \vskip50pt plus12pt minus12pt
    \nobreak
    \gdef\extraspace{\nobreak\bigskip\noindent\ignorespaces}%
    \noindent
    \subno=0 \subsubno=0 
    \global\advance\secno by 1
    \noindent {\bf \the\secno. #1}\par\checkforsub}

% Subsection heading (#1 is title of subsection, no number required)
%
\def\subsection#1{%
     \goodbreak
     \vskip24pt plus12pt minus6pt
     \nobreak
     \gdef\extraspace{\nobreak\medskip\noindent\ignorespaces}%
     \noindent
     \subsubno=0
     \global\advance\subno by 1
     \noindent {\sl \the\secno.\the\subno. #1\par}\checkforsub}

% Subsubsection heading (#1 is title of subsubsection, 
% no number is required)
%
\def\subsubsection#1{%
     \goodbreak
     \vskip20pt plus6pt minus6pt
     \nobreak\noindent
     \global\advance\subsubno by 1
     \noindent {\sl \the\secno.\the\subno.\the\subsubno. #1}\null. 
     \ignorespaces}

% Heading for an appendix, #1 is title of appendix, 
% no number or letter required
%
\def\appendix#1
   {\vskip0pt plus.1\vsize\penalty-250
    \vskip0pt plus-.1\vsize\vskip24pt plus12pt minus6pt
    \subno=0
    \global\advance\appno by 1
    \noindent {\bf Appendix \the\appno. #1\par}
    \bigskip
    \noindent}

% Heading for subsection within an appendix
%
\def\subappendix#1
   {\vskip-\lastskip
    \vskip36pt plus12pt minus12pt
    \bigbreak
    \global\advance\subno by 1
    \noindent {\sl \the\appno.\the\subno. #1\par}
    \nobreak
    \medskip
    \noindent}

% Heading for acknowledgments
%
\def\ack
   {\vskip-\lastskip
    \vskip36pt plus12pt minus12pt
    \bigbreak
    \noindent{\bf Acknowledgments\par}
    \nobreak
    \bigskip
    \noindent}

%%%%%%%%%%%%%%%%%%%%%%%%%Macros for Tables%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Heading for start of tables section
%
\def\tables
   {\vfill\eject
    \noindent {\bf Tables and table captions}\par
    \bigskip}

% Table caption. #1 is caption, no number required
%
\def\tabcaption#1
   {\global\advance\tableno by 1
    \noindent {\bf Table \the\tableno.} \rm#1\par
    \bigskip}


% Definition of boldrule and medrule
%
\def\br{\noalign{\medskip\hrule height1pt\medskip}}
\def\mr{\noalign{\medskip\hrule\medskip}}

% The halign (actually ialign) command for tables 
% (THIS MUST BE COPIED FOR EACH TABLE---WITHOUT THE PER CENT SIGN!)
% 
% \ialign{#\hfil&&\hglue 2pc plus2pc minus1pc#\hfil\cr

% A small negative skip for use in tables
%
\def\ns{\noalign{\vskip-6pt}}

% A macro for a footnote to a table
%
\def\tabnote#1{\noindent #1\par}



% Heading for list of figure captions
%
\def\figures
   {\vfill\eject
    \noindent {\bf Figure captions\par}
    \bigskip}

% Figure caption, #1 is caption, no number required
%
\def\figcaption#1
   {\global\advance\figureno by 1
    \noindent {\bf Figure \the\figureno.} \rm#1\par
    \bigskip}

% Heading for list of references
%
\def\references
     {\vfill\eject 
     {\noindent \bf References\par}
      \parindent=0pt
      \bigskip}

% Heading for list of numbered references
%
\def\numreferences
     {\vfill\eject
     {\noindent \bf References\par}
     \everypar{\parindent=30pt \hang \noindent}
     \bigskip}

% Reference to a journal article in Harvard (alphabetical) system
%
\def\refjl#1#2#3#4
   {\hangindent=16pt
    \hangafter=1
    \rm #1
   {\frenchspacing\sl #2
    \bf #3}
    #4\par}

% Reference to a book or report in Harvard (alphabetical) system
%
\def\refbk#1#2#3
   {\hangindent=16pt
    \hangafter=1
    \rm #1
   {\frenchspacing\sl #2}
    #3\par}

% Reference to a journal article in numerical system
%
\def\numrefjl#1#2#3#4#5
   {\parindent=40pt
    \hang
    \noindent
    \rm {\hbox to 30truept{\hss #1\quad}}#2
   {\frenchspacing\sl #3\/
    \bf #4}
    #5\par\parindent=16pt}

% Reference to a book or report in numerical system
%
\def\numrefbk#1#2#3#4
   {\parindent=40pt
    \hang
    \noindent
    \rm {\hbox to 30truept{\hss #1\quad}}#2
   {\frenchspacing\sl #3\/}
    #4\par\parindent=16pt}

% Dash for use with repeated authors in reference lists
%
\def\dash{---{}---}

\def\ref#1{\noindent \hbox to 21pt{\hss 
#1\quad}\frenchspacing\ignorespaces}

% Fraction, alternative to \over
%
\def\frac#1#2{{#1 \over #2}}

% Renaming the dot under macro
%
\let\du=\d

% \d now used for differential d in mathematics
%
\def\d{{\rm d}}

% \e gives roman e for exponential e in mathematics
%
\def\e{{\rm e}}

% \i gives roman i for square root of minus one in maths mode
% and \ii used for dotless i in text mode

\def\i{{\rm i}}
\chardef\ii="10

% Small (text size) fraction within displayed mathematics
%
\def\case#1#2{{\textstyle{#1\over #2}}}


% et al
%
\def\etal{{\sl et al\/}\ }

% Redefinition of footnote macros to lose rule and remove indentation
%
\def\footnoterule{}
\catcode`\@=11
\def\vfootnote#1{\insert\footins\bgroup
    \interlinepenalty=\interfootnotelinepenalty
    \splittopskip=\ht\strutbox % top baseline for broken footnotes
    \splitmaxdepth=\dp\strutbox \floatingpenalty=20000
    \leftskip=0pt \rightskip=0pt \spaceskip=0pt \xspaceskip=0pt
    \noindent\eightpoint\rm #1\ \ignorespaces\footstrut\futurelet\next\fo@t}

% Special macros for display equations
%
% \eq(#1) will give the equation number (#1) on the right
% instead of \eqno
%
\def\eq(#1){\hfill\llap{(#1)}}
%
\catcode`\@=12
%
% Macro for special accented characters
%
% Vectors with hats
\def\bhat#1{\hbox{\bf\^{\bdi #1}}}
% vectors with overbar
\def\bbar#1{\hbox{\bf\={\bdi #1}}}
% roman characters with right pointing arrow
\def\vect#1{\mathaccent"017E{\mkern2mu\rm #1}\mkern2mu}
%
% Abbreviations for IOPP journals
%
\def\CQG{Classical Quantum Grav.}
\def\IP{Inverse Problems}
\def\JPA{J. Phys. A: Math. Gen.}
\def\JPB{J. Phys. B: At. Mol. Phys.}        %1968-87
\def\jpb{J. Phys. B: At. Mol. Opt. Phys.}   %1988 and onwards
\def\JPC{J. Phys. C: Solid State Phys.}     %1968--1988
\def\JPCM{J. Phys: Condensed Matter}        %1989 and onwards
\def\JPD{J. Phys. D: Appl. Phys.}
\def\JPE{J. Phys. E: Sci. Instrum.}         %1968-89
\def\JPF{J. Phys. F: Metal Phys.}
\def\JPG{J. Phys. G: Nucl. Phys.}           %1975--1988
\def\jpg{J. Phys. G: Nucl. Part. Phys.}     %1989 and onwards
\def\JMPS{J. Moscow Phys. Soc.}
\def\MST{Measurement Sci. Technol.}         %1989 and onwards
\def\NET{Network}
\def\NL{Nonlinearity}
\def\NT{Nanotechnology}
\def\PAO{Pure Appl. Opt.}
\def\PMB{Phys. Med. Biol.}
\def\QO{Quantum Opt.}
\def\RPP{Rep. Prog. Phys.}
\def\SLC{Sov. Lightwave Commun.}
\def\SST{Semicond. Sci. Technol.}
\def\SUST{Supercond. Sci. Technol.}
\def\WRM{Waves in Random Media}
%
% Other commonly quoted journals
%
\def\AC{Acta Crystrallogr.}
\def\AM{Acta Metall.}
\def\AP{Ann. Phys., Lpz.}
\def\APNY{Ann. Phys., NY}
\def\APP{Ann. Phys., Paris}
\def\CJP{Can. J. Phys.}
\def\JAP{J. Appl. Phys.}
\def\JCP{J. Chem. Phys.}
\def\JJAP{Japan J. Appl. Phys.}
\def\JP{J. Physique}
\def\JPhCh{J. Phys. Chem.}
\def\JMMM{J. Magn. Magn. Mater.}
\def\JMP{J. Math. Phys.}
\def\JOSA{J. Opt. Soc. Am.}
\def\JPSJ{J. Phys. Soc. Japan}
\def\JQSRT{J. Quant. Spectrosc. Radiat. Transfer}
\def\NC{Nuovo Cim.}
\def\NIM{Nucl. Instrum. Methods}
\def\NP{Nucl. Phys.}
\def\PL{Phys. Lett.}
\def\PR{Phys. Rev.}
\def\PRL{Phys. Rev. Lett.}
\def\PRS{Proc. R. Soc.}
\def\PS{Phys. Scr.}
\def\PSS{Phys. Status Solidi}
\def\PTRS{Phil. Trans. R. Soc.}
\def\RMP{Rev. Mod. Phys.}
\def\RSI{Rev. Sci. Instrum.}
\def\SSC{Solid State Commun.}
\def\ZP{Z. Phys.}
%
% Miscellaneous definitions
%
% Bold nabla
\def\bnabla{\hbox{\bsy\char'162}}
%
% Bold dot for vector dot products
%
\def\bdot{\,\hbox{\bsy\char'001}\,}
%
% Small space between lines in alignments or displayed maths
\def\ms{\noalign{\vskip4pt plus3pt minus2pt}}
%
% Half line space for within tables or alignments
\def\bs{\noalign{\vskip8pt plus3pt minus2pt}}
%
% Small negative space to close up lines above rules in tables
\def\ns{\noalign{\vskip-3pt}}
%
% greater than approximately signs
% \def\gap{\;\amex{\char'046}\;}           % use these if ams 
%  extension fonts available
% \def\sgap{\;\hbox{\samsx \char'046}\;}   % see above
\def\gap{\;\lower3pt\hbox{$\buildrel > \over \sim$}\;}
%
% less than approximately
%
% \def\lap{\;\amex{\char'056}\;}
% \def\slap{\;\hbox{\samsx \char'056}\;}
\def\lap{\;\lower3pt\hbox{$\buildrel < \over \sim$}\;}
% space between parts of short equations
\def\tqs{\hbox to 25pt{\hfil}}
\let\lc=\lowercase
\def\Or{{\rm O}}   %order of
\def\Cal#1{{\cal #1}}
\let\dsty=\displaystyle
\let\tsty=\textstyle
\let\ssty=\scriptstyle
\let\sssty=\scriptscriptstyle
%
%\def\LaTeX{{\rm L\kern-.36em\raise.3ex\hbox{\eightrm a}\kern-.15em
%    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
%
% Better defn cribbed from `TeX for the Impatient':
%
\def\LaTeX{L\kern-.26em \raise.6ex\hbox{\fiverm A}%
   \kern-.15em\TeX}%
%
\def\AmSTeX{%
{$\cal{A}$}\kern-.1667em\lower.5ex\hbox{%
 $\cal{M}$}\kern-.125em{$\cal{S}$}-\TeX}

\endinput
