Proposition Corollary Definition Lemma

The Extended Zeilberger's Algorithm with Parameters

William Y.C. Chen1, Qing-Hu Hou2 and Yan-Ping Mu3

1,2Center for Combinatorics, LPMC-TJKLC Nankai University Tianjin 300071, P. R. China

3College of Science Tianjin University of Technology Tianjin 300384, P.R. China

1chen@nankai.edu.cn, 2hou@nankai.edu.cn, 3yanping.mu@gmail.com

Dedicated to Professor Wen-Tsun Wu on the occasion of his ninetieth birthday

Keywords: Zeilberger's algorithm, the Gosper algorithm, hypergeometric series, orthogonal polynomials

AMS Subject Classification: 33F10, 33C45, 33D45

Introduction

Based on Gosper's algorithm, Zeilberger [\cite=Zeil91] [\cite=WZ92a] has developed a powerful theory for proving identities on hypergeometric series and basic hypergeometric series. Let F(n,k) be a double hypergeometric term, namely, F(n + 1,k) / F(n,k) and F(n,k + 1) / F(n,k) are both rational functions of n and k. Zeilberger's algorithm is devised to find a double hypergeometric term G(n,k) and polynomials [formula] which are independent of k such that

[formula]

Writing

[formula]

Summing ([\ref=Zeil]) over k, we deduce that

[formula]

Thus the identity

[formula]

can be justified by verifying that f(n) also satisfies [\eqref=rec] and both sides of [\eqref=iden] share the same initial values.

Paule [\cite=Paule05] extended Zeilberger's algorithm to the multi-variable case and found many applications. Let [formula] denote the vector of variables [formula] and [formula] be a multi-variable hypergeometric term, that is,

[formula]

are all rational functions of [formula] and k. Given m shifts [formula] of the variables [formula], he found that one can use a similar procedure to Zeilberger's algorithm to find a multi-variable hypergeometric term [formula] and coefficients [formula] which are independent of k such that

[formula]

The main idea of this paper is the observation that Paule's approach can be further extended to a more general telescoping problem. Let [formula], [formula], [formula] be m similar hypergeometric terms of k with parameters [formula], namely, the ratios

[formula]

are all rational functions of k and [formula]. Find a hypergeometric term [formula], that is, the ratio [formula] is a rational function of k and [formula], and polynomial coefficients [formula], [formula], [formula], [formula] which are independent of k such that

[formula]

For brevity, from now on we may omit the parameters [formula] and write fi(k) for [formula], ai for [formula], and g(k) for [formula]. Once the telescoping relation [\eqref=EZ] is established, summing over k often leads to a homogenous relation among the sums [formula], [formula], [formula]:

[formula]

Let [formula] be a multi-variable hypergeometric term and [formula]. Then [formula] are similar hypergeometric terms of k with parameters [formula]. Therefore, Paule's equation [\eqref=para] is a special case of [\eqref=EZ]. However, we should note that the extended Zeilberger's algorithm is very much in the spirit of the original algorithm of Zeilberger, and it should be regarded as a variation as well because the implementation of the extended algorithm is essentially the same as the original algorithm.

As an application of our algorithm, one can determine whether a given hypergeometric series satisfies the recurrence relation and the structure relations for orthogonal polynomials. Meanwhile, we obtain the coefficients in these relations. For instance, let [formula] be the hypergeometric representation of the Jacobi polynomials as given in [\eqref=jacobi]. Set

[formula]

where Pn,k'(x) denotes the derivative of Pn,k(x) with respect to x. The extended Zeilberger's algorithm enables us to find the structure relation for Pn(x)

[formula]

It is worth mentioning that neither the original Zeilberger's algorithm nor the variation of Paule is directly applicable to the above relation ([\ref=abc]) involving derivatives.

Furthermore, it is important to impose an additional requirement that the coefficients [formula] in [\eqref=EZ] are not only independent of k but also independent of some other parameters such as the variable x occurring as the variable of orthogonal polynomials. For example, ãn,n and n in [\eqref=abc] are required to be independent of the variable x. Based on this parameter-free property of the coefficients, Chen and Sun [\cite=Chen-Sun] have developed a computer algebra approach to proving identities on Bernoulli polynomials and Euler polynomials.

We should notice that Koepf and Schmersau [\cite=Koepf-25] have shown that one can derive the recurrence relation and structure relations for orthogonal polynomials by variations of Zeilberger's algorithm. For each of the three kinds of relations, they have provided an algorithm. The extended Zeilberger's algorithm serves as a unification of their algorithms and applies to more general cases. For instance, our algorithm can also be used to derive recurrence relations for the connection coefficients between two classes of Meixner polynomials with different parameters.

In another direction, the extended Zeilberger's algorithm can be adapted to deal with basic hypergeometric terms. Using the q-analogue of this algorithm, we can recover the three term recurrence relations for the Askey-Wilson polynomials and the q-Racah polynomials.

Let us recall some terminology and notation. A function t(k) is called a hypergeometric term if t(k + 1) / t(k) is a rational function of k. A hypergeometric series is defined by

[formula]

where [formula] is the raising factorial. The q-shifted factorial is given by [formula] and we write

[formula]

Then a basic hypergeometric series is defined by

[formula]

The Extended Zeilberger's Algorithm

Let [formula] be similar hypergeometric terms with parameters [formula]. Recall that two hypergeometric terms f(k) and g(k) are said to be similar if their ratio is a rational function of k and the parameters. We assume that

[formula]

where u(k),v(k),pi(k),Q(k) are polynomials in k and the parameters [formula]. Suppose that fi(k) satisfy [\eqref=fij]. Then

[formula]

and

[formula]

are rational functions of k and [formula]. Thus [\eqref=fij] is equivalent to the statement that [formula] are similar hypergeometric terms.

Our aim is to find coefficients [formula] as rational functions in the parameters [formula] but independent of k (called k-free coefficients) such that

[formula]

for some hypergeometric term g(k) with parameters [formula]. By the similarity of [formula],

[formula]

is a hypergeometric term of k with parameters [formula]. So we can apply Gosper's algorithm [\cite=Gosper78] to find g(k) such that tk = g(k + 1) - g(k). Notice that we always have a trivial solution [formula] and g(k) = 0.

Notice that by multiplying the common denominator, the coefficients [formula] in [\eqref=EZ-a] become polynomials in the parameters [formula]. If no confusion arises, we may not mention the parameters [formula]. In the usual case n is the parameter for identities on finite sums.

It follows from ([\ref=tk]) that

[formula]

Suppose that

[formula]

is a Gosper representation, i.e., a(k),b(k),c(k) are polynomials such that gcd (a(k),b(k + h)) = 1 for all non-negative integers h. Then a Gosper representation of tk + 1 / tk is given by

[formula]

where

[formula]

Gosper's algorithm states that g(k) exists if and only if there exists a polynomial x(k) such that

[formula]

Moreover, the degree bound d for x(k) can be estimated by a(k) and b(k). Suppose

[formula]

By comparing the coefficients of each power of k on both sides, we obtain a system of linear equations on [formula] and [formula]. Solving the system of linear equations, we find coefficients [formula] and

[formula]

The extended Zeilberger's algorithm can be described in terms of the following steps.

Input: m similar hypergeometric terms [formula]. Output: k-free coefficients [formula] and a hypergeometric term g(k) satisfying [\eqref=EZ-a].

Compute the rational functions

[formula]

Set Q(k) to be the common denominator of [formula],

[formula]

and let P(k) be given by [\eqref=Pk].

Compute a Gosper representation of

[formula]

Compute the degree bound d for x(k) and solve the equation [\eqref=G-key] by the method of undetermined coefficients to obtain the k-free coefficients [formula] and the polynomial x(k).

The hypergeometric term g(k) is then given by

[formula]

Suppose that F(n,k) is a double hypergeometric term. Let fi(k)  =  F(n + i - 1,k). Then the extended Zeilberger's algorithm reduces to the original Zeilberger's algorithm. More generally, suppose that [formula], [formula] is a multi-variable hypergeometric term and [formula]. The specialization [formula] reduces to Paule's variation.

As will be seen, in some applications it is necessary to require that the coefficients [formula] be independent of some parameters, say, the parameter a. More precisely, let [formula], [formula], [formula] be m similar multi-variable hypergeometric terms, that is,

[formula]

are rational functions of [formula]. We aim to find [formula] not only independent of k but also independent of the parameter a such that [\eqref=EZ-a] holds.

Since the solutions [formula] of [\eqref=EZ-a] form a linear vector space, we may use the following form as the output

[formula]

where [formula] are free variables and [formula] are linear combinations of [formula]. For this purpose, we should first ignore the independence of a and apply the extended Zeilberger's algorithm to find the solution [\eqref=hh]. By [\eqref=para-rat], the functions [formula] are rational functions of the parameters [formula] and thus can be written as

[formula]

where pi,qi are relatively prime polynomials. Now consider the additional requirement that [formula] are independent of the parameters a. Therefore, all the coefficients of

[formula]

in variable a must be zero. This gives a system of linear equations on [formula] and [formula]. Upon solving these equations, we eventually find [formula] which are independent of k and the parameter a. The above version of the extended Zeilberger's algorithm will still be called the extended Zeilberger's algorithm.

Let us take the Hermite polynomials as the first example to show how to use the above algorithm to derive linear relations on sums of similar hypergeometric terms with parameters.

Example 2.1 The Hermite polynomials Hn(x) are given by

[formula]

see [\cite=AAR99]. We aim to find a three term recurrence

[formula]

with coefficients αn,βn,γn being independent of x. Let

[formula]

be the summand in [\eqref=Hn]. We first ignore the x-freeness requirement and apply the extended Zeilberger's algorithm to the four similar hypergeometric terms with parameters n and x

[formula]

We find that

[formula]

and

[formula]

Now it is time to impose the x-freeness condition to give an additional equation

[formula]

Hence we obtain

[formula]

It follows that

[formula]

Summing over k, we deduce that

[formula]

Orthogonal Polynomials

Using the extended Zeilberger's algorithm, we can determine whether a hypergeometric series satisfies a three term relation and the structure relations for a sequence of orthogonal polynomials. In other words, one can verify the orthogonality of a terminating hypergeometric series by using the extended Zeilberger's algorithm.

The method to derive the relation in Example 2.1 is in fact valid in the general case. Given a hypergeometric series Pn(x), we can compute the coefficients for the following recurrence relation

[formula]

Let [formula], where Pn,k(x) is a hypergeometric term of k with parameters n and x. Set

[formula]

Clearly, f1,f2,f3 and f4 are similar hypergeometric terms. So we can use the extended Zeilberger's algorithm to find a1,a2,a3,a4 which are independent of k and x such that

[formula]

Then summing over k leads to

[formula]

By this method, we can recover the three term recurrences for the Laguerre polynomials, the Jacobi polynomials, the Charlier polynomials, the Meixner polynomials, the Kravchuk polynomials and the Hahn polynomials, as listed in the following table. Notice that we have adopted the notation in [\cite=KS98].

βn = a + 2n + 1, γn = n(a + n)

[formula]

βn = a + n, γn  =  an

[formula]

[formula]

[formula]

Example 3.1 The Wilson polynomials Wn(x) are given by

[formula]

where [formula], see [\cite=Wilson]. Let Wn,k(x2) be the summand of the right hand side multiplied by the factor (a + b)n(a + c)n(a + d)n. Applying the the extended Zeilberger's algorithm to the similar terms

[formula]

we obtain the following relation, see also [\cite=KS98]

[formula]

where

[formula]

[formula]

and

[formula]

Example 3.2 The Racah polynomials Rn(x) are given by

[formula]

see [\cite=A-W79]. The extended Zeilberger's algorithm gives the recurrence relation of the Racah polynomials [\cite=KS98]

[formula]

where

[formula]

[formula]

and

[formula]

Example 3.3 Askey and Ismail [\cite=Askey84] provided two hypergeometric representations for the Pollaczek polynomials:

[formula]

where

[formula]

Using the extended Zeilberger's algorithm, we derive the following three term recurrence from either representation [\cite=Askey84]:

[formula]

We continue to show that the extended Zeilberger's algorithm can be employed to express the derivatives of orthogonal polynomials in terms the original polynomials, and vice versa. Let Pn,k(x) be the summand of the hypergeometric representation of Pn(x) and P'n,k(x) be the derivative of Pn,k(x). It is easily seen that P'n,k(x) is similar to Pn,k(x). This enables us to derive the three term recurrence for P'n(x) and the structure relations for Pn(x) as given below

[formula]

and

[formula]

where σ(x) is a polynomials in x of degree less than or equal to 2 and an,bn,cn,ān,n,n are constants not depending on x. To derive [\eqref=s-1], we set

[formula]

To establish [\eqref=s-2], we set

[formula]

Example 3.4 The monic Jacobi polynomials are given by

[formula]

Let Pn,k(x) denote the summand. Its derivative with respect to x equals

[formula]

Consider the four similar terms

[formula]

By the extended Zeilberger's algorithm with parameters n and x, we find that

[formula]

[formula]

and

[formula]

The following example is concerned with expressing the shifts of orthogonal polynomials with parameters in terms of the original polynomials and their derivatives.

Example 3.5 Let

[formula]

be the Jacobi polynomials, see [\cite=AAR99] [\cite=KS98]. By applying the extended Zeilberger's algorithm to f1(k) = P(a + 1,  b)n,k(x) (f1(k) = P(a,  b + 1)n,k(x), respectively) and

[formula]

we are led to the known relations due to Koepf and Schmersau [\cite=Koepf-25]

[formula]

and

[formula]

Moreover, we can deduce the following relations which seem to be new:

[formula]

and

[formula]

The extended Zeilberger's algorithm can also be employed to compute the connection coefficients of two sequences of orthogonal polynomials. Ronveaux [\cite=Ronveaux] developed an approach to computing recurrence relations for the connection coefficients. The extended Zeilberger's algorithm serves this purpose without resorting to the properties of the orthogonal polynomials. As an example, let us consider the connection coefficients of two classes of Meixner polynomials with different parameters.

Example 3.6 Let M(γ,  μ)n(x) be the monic Meixner polynomials defined by

[formula]

see [\cite=KS98]. We wish to find a recurrence relation for the connection coefficients Cm(n) defined by

[formula]

To this end, we first find a difference operator which eliminates M(γ,  μ)n(x). This goal can be achieved by applying the extended Zeilberger's algorithm to the similar terms

[formula]

where

[formula]

From the telescoping relation generated by the extended Zeilberger's algorithm, we deduce that

[formula]

Let

[formula]

which can be used to establish a linear relation on the connection coefficients Cm(n). Indeed, it follows from [\eqref=M-M] that

[formula]

Suppose that we can express Sm(x) in terms of a suitable basis {Pm(x)}:

[formula]

where am,bm and cm are independent of x. Substituting ([\ref=S-P]) into ([\ref=cm]), by the linear independence of Pm(x) for [formula], that is, the coefficients of Pi(x) are all zeros, we find

[formula]

Thus the question has become how to find the polynomials Pm(x) in order to determine the coefficients am, bm and cm. In view of the relation [\eqref=S-P], we consider a hypergeometric term Pm(x) that is similar to Sm(x) so that we can solve the equation

[formula]

by using the extended Zeilberger's algorithm. In fact, we may choose

[formula]

It is easily checked that Pm(x) satisfies [\eqref=S-P] and the corresponding coefficients are given by

[formula]

[formula]

Hence we have derived a recurrence relation [\eqref=C-rec] for the connection coefficients Cm(n).

q-Orthogonal Polynomials

The extended Zeilberger's algorithm can be readily adapted to basic hypergeometric terms tk with parameters [formula], that is, the ratio of two consecutive terms is a rational function of qk and the parameters. The q-analogue of the extended Zeilberger's algorithm will be called the extended q-Zeilberger's algorithm. Let f1(k), [formula] be similar q-hypergeometric terms, namely,

[formula]

are rational functions of qk and the parameters. The objective of the extended q-Zeilberger's algorithm is to find a q-hypergeometric term g(k) and coefficients a1, [formula] which are independent of k such that

[formula]

The detailed description of the extended q-Zeilberger's algorithm is similar to that of the ordinary case, hence is omitted. We will only give examples to demonstrate how to use this method to compute the three term recurrences and structure relations for q-orthogonal polynomials.

Example 5.1 The discrete q-Hermite I polynomials are given by [\cite=AC65]

[formula]

Let [formula] be the q-difference of Hn(x). We derive that

[formula]

and

[formula]

Example 5.2 The Askey-Wilson polynomials pn(x;a,b,c,d|q) are defined by

[formula]

see [\cite=GasRah04]. Let tn,k(x) be the summand of the right hand side multiplied by (ab,ac,ad;q)n / an. Applying the extended q-Zeilberger's algorithm to

[formula]

we find that

[formula]

where

[formula]

[formula]

and

[formula]

Example 5.3 The q-Racah polynomials Rn(x;a,b,c,d|q) are given by

[formula]

see [\cite=KS98]. The extended q-Zeilberger's algorithm gives the following recurrence relation first derived by Askey and Wilson [\cite=A-W79] using a transformation formula on a [formula] series:

[formula]

where

[formula]

[formula]

and

[formula]

This work was supported by the 973 Project on Mathematical Mechanization, the National Natural Science Foundation, the PCSIRT project of the Ministry of Education, and the Ministry of Science and Technology of China. Y.-P. Mu was supported by National Natural Science Foundation of China, Project 10826038.