Advanced Self-interference Cancellation and Multiantenna Techniques for Full-Duplex Radios

Introduction

Full-duplex communications, where a transceiver transmits and receives signals on the same frequency and time slot, has gained a lot of interest in the recent years, e.g., [\cite=bliss] [\cite=Choi10] [\cite=Duarte12] [\cite=Jain11] [\cite=Bharadia13] [\cite=Riihonen12] [\cite=Riihonen1222]. These systems provide radical improvement in spectral efficiency over half-duplex systems, especially in relaying applications, where the frequencies can be reused. This leads to efficient utilization of the available spectrum. The main bottleneck in designing such in-band full duplex systems is the self-interference (SI) at the receiver caused by its own transmission. In order to mitigate the SI, cancellation must be done at the antenna, radio frequency (RF), and digital domains.

Although previous work has been done to cancel the SI, the achieved cancellation levels need to be improved for practical implementations and robust solutions are necessary. In this regard, we propose different techniques to mitigate the SI signal in the antenna and digital domains. Since it is expected that relays are the first candidates for such full-duplex systems, in Section [\ref=sec:antenna] we suggest isolation improvement techniques in the antenna domain for a compact relay using loops for field suppression. Section [\ref=sec:digital] discusses the nonlinearities occurring in the receiver chain of a full-duplex transceiver and proposes an algorithm to estimate and cancel a nonlinearly distorted SI signal. Finally, the conclusions are drawn in Section [\ref=sec:conc].

Antenna Isolation Improvement for a Compact Relay

In this section, we consider the scenario of a compact relay with back-to-back antennas operating at the same frequency and time slot, as depicted in Fig. [\ref=fig:relay_diagram]. The full-duplex relay operates at the same frequency for the the source-to-relay, and relay-to-destination downlinks [\cite=Riihonen124]. The uplink and downlink frequencies or timeslots are different. These compact relays can be used in outdoor-to-indoor scenarios or installed on lamp-posts as hotspots to improve the dead-spot coverage and provide higher capacity to the end user.

Based on the earlier work in [\cite=RefWorks:13] on measurements of the loop-back interference channel, the following specifications were considered for designing the compact relay:

the relay dimension is comparable to that of a wireless access point, and

the relay antennas operate at 2.6 GHz with a minimum bandwidth of 100 MHz.

We consider two dual-polarized patch antennas placed back-to-back as shown in Fig. [\ref=fig:relay_reference_antenna]. The antenna on one ground plane is used for the source-to-relay link and the antenna on the second ground plane is used for the relay-to-destination link. The antennas on one side of the ground plane are tilted by [formula] to improve the isolation. As the separation distance between the transmit (TX) and receive (RX) antennas is electrically small, i.e., 0.156λ at 2.6 GHz, we need to analyze the near fields created by the antennas to calculate the isolation between them. The isolation level obtained is the SI cancellation achieved between the TX and RX antennas.

In order to improve the isolation for this antenna, different methods can be used, including the use of wavetraps [\cite=wavetrap], band-gap structures [\cite=ebg], slots on the ground plane [\cite=slots] and RF absorbers. In this paper, we investigate the use of loops to cancel the magnetic field and hence improve the isolation between the TX and RX antennas. When investigating the electromagnetic fields around the antenna using HFSS simulations, which uses the finite element method [\cite=hfss], it was observed that the near-field impedance, which is the ratio of the transverse electric and magnetic fields, was less than [formula]. This indicates that the magnetic fields are dominant in the region between the ground planes. Hence, cancellation of the magnetic fields can provide an improvement in the isolation.

To this end, loops were designed on the ground plane on one side of the relay as shown in Fig. [\ref=fig:relay_with_loop]. The concept of using loops stems from Faraday's law of electromagnetic induction and Lenz's law [\cite=cheng]. The induced currents in the loops create magnetic fields, which oppose the change in the flux producing it, thereby partially cancelling the local reactive magnetic fields produced by the antenna. Figs. [\ref=fig:isolation_ref] and [\ref=fig:isolation_with_loops] show the isolation of the relay antenna without the field cancellation loops and with the loops on the ground plane, respectively. It can be observed that, at the operating frequency of 2.6 GHz, we have an improvement of 6 dB in the worst case isolation shown by the black circles, indicating a minimum isolation of 55 dB between the transmit and receive antennas. The isolation can be further improved by combining different techniques mentioned above for practical deployment of full-duplex relays.

Cancellation of RX-induced Nonlinear Distortion

In addition to antenna attenuation and possible analog SI cancellation, usually additional SI attenuation is required in the digital domain. This is due to the fact that the power of the SI is usually not attenuated sufficiently in the analog domain and thus, without further SI suppression in the digital domain, the decrease in the receiver chain signal-to-interference-plus-noise ratio (SINR) would be intolerable. Traditionally, the SI suppression in the digital domain, or digital cancellation, has been performed using linear processing methods. This means that the SI coupling channel, including the effects of transmit chain, actual coupling channel between the antennas, and receiver chain, is estimated with linear channel estimation methods [\cite=Choi10] [\cite=Jain11] [\cite=Duarte12] [\cite=Sahai11]. However, the power of the own transmit signal entering the receiver chain may be in the order of 60-80 dB higher than the power of the weak received signal of interest. Thus, unless assuming highly linear receiver components, the power the total signal entering the receiver chain may be high enough to drive the components out of their linear operating region. This means that the total signal will be distorted nonlinearly in the receiver chain, and it is not possible to regenerate and suppress the SI signal using a linear SI channel estimate.

There have recently been studies on nonlinear SI cancellation, but none of them concentrate on RX-induced nonlinear distortion [\cite=Anttila13] [\cite=Ahmed13] [\cite=Bharadia13]. In this paper, it will be shown that nonlinear distortion produced in the receiver chain can indeed limit the performance of a full-duplex transceiver, and this provides strong motivation to develop an algorithm capable of attenuating also a nonlinearly distorted SI signal. Thus, we describe an algorithm capable of estimating and modeling nonlinear distortion, which will increase the amount of achieved digital cancellation in a typical full-duplex transceiver.

MIMO Full-duplex Transceiver Model

To allow for a more general scenario, in this paper a MIMO direct-conversion full-duplex transceiver is assumed. Thus, there are several transmitters and receivers operating simultaneously in the considered transceiver. This means that the total SI signal coupling to a single receiver antenna consists of the sum of all the transmitted signals. An ideal baseband model of this type of a MIMO full-duplex transceiver is presented in, e.g., [\cite=Riihonen12]. For the different calculations and modeling, a 2x2 MIMO is considered in this paper, meaning that the full-duplex transceiver has two transmit antennas, two receiver antennas, and four RF chains. A block diagram of this transceiver is shown in Fig. [\ref=fig:block_diagram].

The considered MIMO full-duplex transceiver model has two active SI cancellation stages, in addition to passive antenna attenuation. At the input of each receiver chain, RF cancellation is performed, where the transmitted signals are subtracted from the received signal. After the actual receiver chain, further SI cancellation is performed in the digital domain. This is done by estimating the channel of the SI signal and then regenerating it based on the channel estimate. The novel nonlinear SI cancellation algorithm proposed in this paper is in essence increasing the precision of the regenerated SI signal, and thus increasing the amount of achievable digital SI cancellation when operating with practical nonlinear RF components.

To model a realistic scenario, it is assumed that the receiver chains of the considered MIMO full-duplex transceiver have typical low to medium-cost components. This means that the linearity of the amplifiers and IQ mixer is not as high as for the more expensive state of the art components. The considered parameter values are listed in Tables [\ref=table:system_parameters] and [\ref=table:parameters]. Since the objective of this analysis is to determine the effect of the receiver chain nonlinearities, it is assumed that the PAs of the transmit chains are completely linear. This allows for a detailed analysis of only the RX-induced nonlinear distortion.

RX-induced Nonlinearities in a MIMO Full-Duplex Transceiver

To obtain some insight into the effect of receiver chain induced nonlinear distortion occuring in a full-duplex transceiver, simplified system calculations are performed. This reveals the approximate power levels of the different signal components after linear digital cancellation for one receiver chain. In this analysis, the power levels are calculated with respect to transmit power of a single transmit antenna under the assumption that all the transmit chains use the same transmit power. A detailed derivation of all the necessary equations for a SISO scenario can be found in [\cite=Korpi13]. In this analysis, it is assumed that digital cancellation attenuates the linear SI component slightly below the thermal noise floor. This is a reasonable assumption in this context, as the purpose of this simplified example is to illustrate the relative power level of the receiver chain induced nonlinear distortion.

The different power levels of the signal components for one receiver chain, corresponding to the chosen parameters, are shown in Fig. [\ref=fig:p_all_example]. It can be observed that the 2nd- and 3rd-order RX-chain induced nonlinearities are the most significant distortion components with transmit powers above 10 dBm. Furthermore, it is evident that the strength of the nonlinear distortion is sufficient to significantly degrade the SINR with high transmit powers. Thus, the capability to model and attenuate also a nonlinearly distorted SI signal will provide performance gain for a full-duplex transceiver, especially with higher transmit powers.

Nonlinear SI Cancellation Algorithm and Parameter Estimation

The nonlinear distortion occuring in the receiver chain of a full-duplex transceiver can be approximated with polynomials. There have been previous studies on modeling the nonidealities of receiver chains [\cite=Grimm13], and thus the models for the nonlinearities are not derived in this paper. Instead, a model presented in [\cite=Grimm13] is used, with the addition of a 2nd-order nonlinear term, produced by the baseband components and the IQ mixer. The baseband equivalent model for the low-noise amplifier is now yRF,i(t)  =  kLNAxi,in(t) + αi|xi,in(t)|2xi,in(t), where xi,in(t) is the input signal of the ith receiver chain. The combined baseband equivalent model for the IQ mixer and variable gain amplifier can be expressed as [formula], where [formula] denotes the complex conjugate. During a training period when there is no actual signal of interest present, the overall signal model at the digital baseband of one receiver chain is as follows:

[formula]

where xi,in(n) is now the total SI signal at the input of the ith receiver chain, ai,k are the combined coefficients of the different linear and nonlinear terms, and zi(n) represents the other noise sources. Here, only terms up to 3rd order are considered, as it was observed that the higher-order terms are insignificant with the chosen parameters. Based on [\eqref=eq:sig_model], it is possible to calculate the coefficients of the different terms by stacking the sampled signals to vectors of observation period N.

However, for that, the input signal of the receiver chain must first be determined. This can be done by obtaining an estimate of the linear SI coupling channel with a low transmit power. In that case, the receiver chain can be assumed to be completely linear, and linear channel estimation provides an accurate result. The signal model during a training period, assuming a low transmit power, can be written as follows:

[formula]

where Ntx is the number of transmit antennas and hij(n) is the effective channel experienced by the jth transmit signal xj(n) when propagating to the ith receiver, including the effects of linear RF cancellation and the receiver chain. Because of the MIMO context, the total SI signal is a sum of all the transmit signals, each of which experiences a slightly different coupling channel. With vector notations, and using again an observation period of N samples, [\eqref=eq:lowtx_model] can be rewritten as follows:

[formula]

where

[formula]

and [formula] is a covariance windowed convolution matrix of the form

[formula]

Here, M denotes the length of the channel estimate. This same signal model is also presented in [\cite=Riihonen12] with matrix notations. Now, the SI channel responses for each receiver can be calculated by, e.g., linear least squares as follows:

[formula]

where [formula], and ()H denotes the Hermitian transpose. Since low transmit power is used during this training period, the effect of the receiver chain can be approximated by merely a scalar multiplication. Thus, [formula] includes in fact estimates of the channels experienced by the transmit signals before the ith receiver chain, scaled by the amplification of the receiver chain in question. Assuming that the channels change sufficiently slowly, these channel estimates can be used to form an estimate of the receiver chain input signal during another training period, where the coefficients of the nonlinear terms are then calculated.

To determine the coefficients of the nonlinear terms, the signal model presented in [\eqref=eq:sig_model] must first be written with vector notations as follows:

[formula]

where

[formula]

and all the transformations in the matrix [formula] are performed element-wise to the column vector [formula]. As this signal model is linear in parameters, the coefficients [formula] can be calculated with linear least squares as follows.

[formula]

Since this estimation procedure is performed during a training period with an arbitrary transmit power, the signal [formula] might also be nonlinearly distorted, unlike previously.

Now, using the linear channel estimates [formula] and the known transmit signals xj(n) to form an estimate of the receiver chain input signal [formula], the estimates for the coefficients of the nonlinear terms [formula] can be calculated with [\eqref=eq:nonlinear_ls]. With these estimates, it is possible to reconstruct the SI signal when using the same transmit power that was used during the estimation of the coefficients. Thus, even a nonlinearly distorted SI signal can be suppressed in the digital domain by knowing only the transmitted symbols, as long as the overall channel remains approximately constant.

Waveform Simulations

To evaluate the performance of the proposed algorithm, waveform simulations are performed. The same transceiver model is used as presented in Fig. [\ref=fig:block_diagram], with the parameters shown in Tables [\ref=table:system_parameters] and [\ref=table:parameters]. Furthermore, in the simulations an OFDM signal is assumed, with the parameters presented in Table [\ref=table:ofdm_param]. Basically, these parameters correspond to a WLAN system. In addition, the two transmit data streams are independent. The lengths of the channel estimate (M) and observation period (N) are chosen to be 5 and 10000, respectively. In the simulations, the transmit power is varied with 2.5 dB intervals, and 20 realizations are calculated for each transmit power. The SINR for each transmit power is calculated as the average value of these realizations.

The simulated SINRs corresponding to one receiver chain, with respect to the transmit power of a single antenna, are presented in Fig. [\ref=fig:sinr_simul]. The SINR is shown for three scenarios: using only linear digital SI cancellation for a nonlinear receiver chain, and using the proposed nonlinear digital SI cancellation algorithm for nonlinear and linear receiver chains. There are two significant observations that can be made from the figure. Firstly, it can be observed that the proposed nonlinear SI cancellation algorithm increases the achievable SINR significantly with higher transmit powers, when compared to using only linear digital cancellation. Secondly, even with a completely linear receiver chain, the proposed algorithm is not able to achieve the ideal SINR of 15 dB, which corresponds to a situation where the SI signal is cancelled completely. The reason for this lies in the estimation procedure of the linear SI channel, which is done with a lower transmit power to ensure the linearity of the receiver chain. The lower transmit power means that the power of the SI signal is also lower with respect to the noise floor, and this results in a more noisy SI channel estimate than could be achieved with a higher SI power. Thus, the estimate of the receiver chain input signal is also noisy, which decreases the achievable SINR with higher transmit powers, where very precise channel estimates are required to suppress the SI signal below the noise floor. Anyway, the proposed nonlinear digital SI cancellation algorithm still achieved higher SINRs than when using linear processing methods, indicating that it is indeed beneficial to model also the nonlinearities occuring in the receiver chain.

Conclusion

We have presented methods to mitigate the self-interference in the antenna and digital domains. Antenna isolation level of 55 dB was achieved in a compact relay using loops for field suppression. In the digital domain, an algorithm capable of cancelling a nonlinearly distorted self-interference signal was proposed, assuming a nonlinear receiver chain. Although these techniques provide solutions to attenuate self-interference, further work is necessary to design cancellation techniques for practical implementations of such systems.